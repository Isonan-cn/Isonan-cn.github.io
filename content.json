{"pages":[{"title":"categories","text":"","link":"/categories/index.html"},{"title":"about","text":"","link":"/about/index.html"},{"title":"plans","text":"题目 文明 虚树做法 树`O(n^3)`做法 优秀的拆分 minimax 算法 类欧几里得 扩展KMP 文章 【学习笔记】后缀自动机 找相同字符 品酒大会 事情的相似度","link":"/plans/index.html"},{"title":"tags","text":"","link":"/tags/index.html"},{"title":"links","text":"memset0:https://memset0.cnlyc:https://lnrbhaw.github.ioyx:https://www.cnblogs.com/DreamlessDreamsDilute:https://dilute.xyz","link":"/links/index.html"}],"posts":[{"title":"2021 计蒜之道 精英组 决赛 Day2T2 题解","text":"对于非负整数 $ k $ ，定义数列 $ f $ ，满足 f_0=0,f_1=1 \\\\ f_n=kf_{n-1}+f_{n-2}(n>1) 读入 $ n,k,d,m $ ，求 \\sum\\_{i=1}^{n}\\sum\\_{j=1}^{i}[i\\perp j](f\\_i,f\\_{j+d}) \\pmod m $1\\le n\\le 10^6,0\\le k,d,m\\le 2^{30}$ 2题解： 本题中定义 $ (0,a)=a $。 首先可以发现对于任意非负整数 $ n,m $ ， $ (f_n,f_m)=f_{(n,m)} $。证明比较平凡，考虑 $ (a,b)=(a+b,b) $ 即可。 那么令$g=f*\\mu$，则有 \\sum_{i=1}^{n}\\sum_{j=1}^{i}\\[i\\perp j\\](f_i,f_{j+d}) \\\\ =\\sum_{i=1}^{n}\\sum_{j=1}^{i}\\[i\\perp j\\]f_{(i,j+d)} \\\\ =\\sum_{i=1}^{n}\\sum_{j=1}^{i}\\[i\\perp j\\]\\sum_{q|i,q|j+d}g_q \\\\ =\\sum_{q=1}^{n}g_q\\sum_{i=1,q|i}^{n}\\sum_{j=1}^{i}\\[i\\perp j\\]\\[q|j+d\\] \\\\ =\\sum_{q=1,q\\perp d}^{n}g_q\\sum_{i=1,q|i}^{n}\\sum_{j=1}^{i}\\[{i\\over (i,q^\\infty)}\\perp j\\]\\[q|j+d\\] \\\\ =\\sum_{q=1,q\\perp d}^{n}g_q\\sum_{i=1,q|i}^{n}\\sum_{j=1}^{i}\\[q|j+d\\]\\sum_{r|{i\\over (i,q^\\infty)}}\\mu(r)\\[r|j\\] \\\\ =\\sum_{q=1,q\\perp d}^{n}g_q\\sum_{i=1,q|i}^{n}\\sum_{r|{i\\over (i,q^\\infty)}}\\mu(r)\\sum_{j=1}^{i}\\[q|j+d\\][r|j]注意到$q\\perp r$，所以在$r,2r,\\dots,i$中恰好有$i\\over qr$个$j$满足$[q|j+d]$。于是 原式=\\sum_{q=1,q\\perp d}^{n}g_q\\sum_{i=1,q|i}^{n}\\sum_{r|{i\\over (i,q^\\infty)}}\\mu(r){i\\over qr} \\\\ =\\sum_{q=1,q\\perp d}^{n}g_q\\sum_{r\\perp q}\\mu(r)S_{\\lfloor{n\\over qr}\\rfloor}这里$S_i=1+2+\\dots+i$。 该式可以在$O(n\\log \\log n)$内解决。","link":"/2021/06/14/jisuanke-18906-t2/"}],"tags":[{"name":"OI","slug":"OI","link":"/tags/OI/"}],"categories":[]}